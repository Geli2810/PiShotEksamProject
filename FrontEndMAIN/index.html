<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basketball Game</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="app" v-cloak>
        
        <!-- LOBBY -->
        <div v-if="!gameActive" class="container lobby">
            <h1>GAME LOBBY</h1>
            
            <!-- Profile Creator -->
            <div class="create-box">
                <h3>Create New Profile</h3>
                <input v-model="newName" placeholder="Player Name">
                <!-- File Input for Image -->
                <input type="file" @change="handleFileUpload" accept="image/*">
                <button @click="createProfile">Create</button>
            </div>

            <!-- Match Setup -->
            <div class="selectors">
                <!-- Player 1 -->
                <div class="col">
                    <h3>PLAYER 1</h3>
                    <select v-model="selectedP1">
                        <option v-for="p in profiles" :value="p.id">
                            {{ p.name }} (W:{{p.wins}} / L:{{p.losses}})
                        </option>
                    </select>
                    <!-- Stats Preview -->
                    <div v-if="selectedP1" class="stats-preview">
                        <img :src="getProfile(selectedP1).profileImage || 'https://cdn.nba.com/headshots/nba/latest/1040x760/1449.png'" class="avatar-small">
                        <p>Accuracy: {{ getProfile(selectedP1).accuracy }}%</p>
                        <p>Win Ratio: {{ getProfile(selectedP1).winLossRatio }}</p>
                    </div>
                </div>

                <!-- Player 2 -->
                <div class="col">
                    <h3>PLAYER 2</h3>
                    <select v-model="selectedP2">
                        <option v-for="p in profiles" :value="p.id">
                             {{ p.name }} (W:{{p.wins}} / L:{{p.losses}})
                        </option>
                    </select>
                    <!-- Stats Preview -->
                    <div v-if="selectedP2" class="stats-preview">
                        <img :src="getProfile(selectedP2).profileImage || 'https://www.usab.com/imgproxy/-AvpbjLzGRGH5tsHJROybQMh0x0T1rYboWbZk7y99wI/rs:fit:3000:0:0/g:ce/q:90/aHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3VzYWItY29tLXByb2QvMjAyMS8wMi8wMDdmOGYwZC0yMTk0LTRjY2UtOTI0Zi0wZWI0YmY4YzgzYTEuanBn.png'" class="avatar-small">
                        <p>Accuracy: {{ getProfile(selectedP2).accuracy }}%</p>
                        <p>Win Ratio: {{ getProfile(selectedP2).winLossRatio }}</p>
                    </div>
                </div>
            </div>

            <button class="start-btn" @click="startGame">START MATCH</button>
        </div>

        <!-- SCOREBOARD -->
        <div v-else class="container scoreboard">
            <header>
                <div class="live">‚óè LIVE</div>
            </header>

            <!-- Winner Overlay -->
            <div v-if="winner" class="winner-overlay">
                <img :src="winner.profileImage || 'https://via.placeholder.com/150'" class="avatar-large">
                <h1>{{ winner.name }} WINS!</h1>
                <button @click="finishGame">RECORD & EXIT</button>
            </div>

            <div class="score-row">
                <!-- P1 Card -->
                <div class="card" :class="{leader: isLeader(p1Data)}">
                    <img :src="p1Profile.profileImage || 'https://cdn.nba.com/headshots/nba/latest/1040x760/1449.png'" class="avatar">
                    <h2>{{ p1Profile.name }}</h2>
                    <div class="score">{{ p1Data.score }}</div>
                </div>
                
                <div class="vs">VS</div>

                <!-- P2 Card -->
                <div class="card" :class="{leader: isLeader(p2Data)}">
                    <img :src="p2Profile.profileImage || 'https://www.usab.com/imgproxy/-AvpbjLzGRGH5tsHJROybQMh0x0T1rYboWbZk7y99wI/rs:fit:3000:0:0/g:ce/q:90/aHR0cHM6Ly9zdG9yYWdlLmdvb2dsZWFwaXMuY29tL3VzYWItY29tLXByb2QvMjAyMS8wMi8wMDdmOGYwZC0yMTk0LTRjY2UtOTI0Zi0wZWI0YmY4YzgzYTEuanBn.png'" class="avatar">
                    <h2>{{ p2Profile.name }}</h2>
                    <div class="score">{{ p2Data.score }}</div>
                </div>
            </div>
        </div>

    </div>
    <script src="app.js"></script>
</body>
</html>